# Store Monitoring System

The Store Monitoring System is a Django-based application designed to track and report uptime and downtime for stores. The system generates reports containing uptime and downtime data, which are then saved as CSV files.

## Logic to calculate uptime and downtime data

1. To calculate uptime and downtime, start by initializing a dictionary with zero values for both "uptime" and "downtime."
2. Determine the time delta based on the specified period (hour, day, or week) and calculate the period's start time.
3. Check if the store is open during the current time frame by filtering store timings and comparing them with the current day and time.
4. If the store is not open, return the zeroed data.
5. Otherwise, fetch the store's status logs from the calculated start time to the current time, ordering them by timestamp.
6. If there are no logs, return the zeroed data.
7. For hourly periods, extract timestamps and status from logs, compute the intervals between consecutive timestamps in minutes, and calculate uptime and downtime by summing the intervals based on the store's status.
8. For daily or weekly periods, accumulate the total minutes the store was active by iterating through the logs and checking if each timestamp falls within the store's operating hours.
9. Compute uptime by dividing the total active minutes by 60 and downtime by subtracting the uptime from the total possible hours in the period.
10. Append the unit of measurement to the data dictionary and return it.

# Set up

1. Clone the repository:

```
git clone git https://github.com/NayashaPrakash/Store-Monitor.git

```

2. Set up a virtual environement.

```
python3 -m venv venv
source venv/bin/activate

```

Move the project directory. (here store)

3. Install necessary dependencies.
4. Set up database.

```
python manage.py migrate

```

5. Start the server.

```
python manage.py runserver

```

# Test APIs :

1. Trigger Report

Ex-

```
 curl --request GET \
--url http://localhost:8000/store/561574537151816086/trigger_report/ \
--header 'Content-Type: application/json' \
--data '	'
```

3. Get Report
   Replace the report id 1 with the one generated by trigger report endpoint to check the status of that report.
   Ex-

```
 curl --request POST \
--url http://localhost:8000/store/get_report/ \
--header 'Content-Type: application/json' \
--data '{
	"report_id": 1

}'
```
